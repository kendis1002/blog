---
title: 'Dẫn xuất Ước lượng OLS'
date: '2020-12-21'
tags: ['next js', 'math', 'ols']
draft: false
summary: 'Cách dẫn xuất Ước lượng OLS bằng ký hiệu ma trận và hướng dẫn định dạng toán học sử dụng markdown với sự trợ giúp của KaTeX.'
---

# Giới thiệu

Việc phân tích và hiển thị các phương trình toán học được bao gồm trong mẫu blog này. Phân tích toán học được kích hoạt bởi `remark-math` và `rehype-katex`.
KaTeX và phông chữ liên quan của nó được bao gồm trong `_document.js` nên bạn có thể tự do sử dụng nó trên bất kỳ trang nào.
[^footnote]

[^footnote]: Để xem danh sách đầy đủ các hàm TeX được hỗ trợ, hãy kiểm tra [tài liệu KaTeX](https://katex.org/docs/supported.html)

Các ký hiệu toán học nội dòng có thể được bao gồm bằng cách đặt thuật ngữ giữa ký hiệu `$`.

Các khối mã toán học được ký hiệu bằng `$$`.

Nếu bạn định sử dụng ký hiệu `$` thay vì toán học, bạn có thể thoát nó (`\$`), hoặc chỉ định thực thể HTML (`&dollar;`) [^2]

Chú thích cuối trang nội dòng hoặc được đánh số thủ công cũng được hỗ trợ. Nhấp vào các liên kết ở trên để xem chúng hoạt động.

[^2]: \$10 và &dollar;20.

# Dẫn xuất Ước lượng OLS

Sử dụng ký hiệu ma trận, gọi $n$ là số quan sát và $k$ là số biến hồi quy.

Véc-tơ của các biến kết quả $\mathbf{Y}$ là một ma trận $n \times 1$,

```tex
\mathbf{Y} = \left[\begin{array}
  {c}
  y_1 \\
  . \\
  . \\
  . \\
  y_n
\end{array}\right]
```

$$
\mathbf{Y} = \left[\begin{array}
  {c}
  y_1 \\
  . \\
  . \\
  . \\
  y_n
\end{array}\right]
$$

Ma trận của các biến hồi quy $\mathbf{X}$ là một ma trận $n \times k$ (hoặc mỗi hàng là một véc-tơ $k \times 1$),

```latex
\mathbf{X} = \left[\begin{array}
  {ccccc}
  x_{11} & . & . & . & x_{1k} \\
  . & . & . & . & .  \\
  . & . & . & . & .  \\
  . & . & . & . & .  \\
  x_{n1} & . & . & . & x_{nn}
\end{array}\right] =
\left[\begin{array}
  {c}
  \mathbf{x}'_1 \\
  . \\
  . \\
  . \\
  \mathbf{x}'_n
\end{array}\right]
```

$$
\mathbf{X} = \left[\begin{array}
  {ccccc}
  x_{11} & . & . & . & x_{1k} \\
  . & . & . & . & .  \\
  . & . & . & . & .  \\
  . & . & . & . & .  \\
  x_{n1} & . & . & . & x_{nn}
\end{array}\right] =
\left[\begin{array}
  {c}
  \mathbf{x}'_1 \\
  . \\
  . \\
  . \\
  \mathbf{x}'_n
\end{array}\right]
$$

Véc-tơ của các số hạng sai số $\mathbf{U}$ cũng là một ma trận $n \times 1$.

Đôi khi có thể dễ dàng hơn khi sử dụng ký hiệu véc-tơ. Để nhất quán, tôi sẽ sử dụng chữ x in đậm để biểu thị một véc-tơ và chữ in hoa để biểu thị một ma trận. Các quan sát đơn lẻ được ký hiệu bằng chỉ số dưới.

## Bình phương nhỏ nhất

**Bắt đầu**:  
$$y_i = \mathbf{x}'_i \beta + u_i$$

**Các giả định**:

1. Tuyến tính (đã cho ở trên)
2. $E(\mathbf{U}|\mathbf{X}) = 0$ (độc lập có điều kiện)
3. rank($\mathbf{X}$) = $k$ (không có đa cộng tuyến, tức là hạng đầy đủ)
4. $Var(\mathbf{U}|\mathbf{X}) = \sigma^2 I_n$ (Phương sai đồng nhất)

**Mục tiêu**:  
Tìm $\beta$ để tối thiểu hóa tổng bình phương sai số:

$$
Q = \sum_{i=1}^{n}{u_i^2} = \sum_{i=1}^{n}{(y_i - \mathbf{x}'_i\beta)^2} = (Y-X\beta)'(Y-X\beta)
$$

**Lời giải**:  
Gợi ý: $Q$ là một vô hướng $1 \times 1$, theo tính đối xứng $\frac{\partial b'Ab}{\partial b} = 2Ab$.

Lấy đạo hàm ma trận theo $\beta$:

```tex
\begin{aligned}
  \min Q           & = \min_{\beta} \mathbf{Y}'\mathbf{Y} - 2\beta'\mathbf{X}'\mathbf{Y} +
  \beta'\mathbf{X}'\mathbf{X}\beta \\
                   & = \min_{\beta} - 2\beta'\mathbf{X}'\mathbf{Y} + \beta'\mathbf{X}'\mathbf{X}\beta \\
  \text{[FOC]}~~~0 & =  - 2\mathbf{X}'\mathbf{Y} + 2\mathbf{X}'\mathbf{X}\hat{\beta}                  \\
  \hat{\beta}      & = (\mathbf{X}'\mathbf{X})^{-1}\mathbf{X}'\mathbf{Y}                              \\
                   & = (\sum^{n} \mathbf{x}_i \mathbf{x}'_i)^{-1} \sum^{n} \mathbf{x}_i y_i
\end{aligned}
```

$$
\begin{aligned}
  \min Q           & = \min_{\beta} \mathbf{Y}'\mathbf{Y} - 2\beta'\mathbf{X}'\mathbf{Y} +
  \beta'\mathbf{X}'\mathbf{X}\beta \\
                   & = \min_{\beta} - 2\beta'\mathbf{X}'\mathbf{Y} + \beta'\mathbf{X}'\mathbf{X}\beta \\
  \text{[FOC]}~~~0 & =  - 2\mathbf{X}'\mathbf{Y} + 2\mathbf{X}'\mathbf{X}\hat{\beta}                  \\
  \hat{\beta}      & = (\mathbf{X}'\mathbf{X})^{-1}\mathbf{X}'\mathbf{Y}                              \\
                   & = (\sum^{n} \mathbf{x}_i \mathbf{x}'_i)^{-1} \sum^{n} \mathbf{x}_i y_i
\end{aligned}
$$
